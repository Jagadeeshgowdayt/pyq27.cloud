<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Test</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #222; 
            color: #fff; 
        }
        .test { 
            margin: 10px 0; 
            padding: 10px; 
            background: #333; 
            border-radius: 5px; 
        }
        .success { background: #2d5a2d; }
        .error { background: #5a2d2d; }
    </style>
</head>
<body>
    <h1>üß™ Simple Connection Test</h1>
    <div id="results"></div>

    <script>
        const results = document.getElementById('results');
        
        function addResult(message, success = true) {
            const div = document.createElement('div');
            div.className = `test ${success ? 'success' : 'error'}`;
            div.innerHTML = `<strong>${success ? '‚úÖ' : '‚ùå'}</strong> ${message}`;
            results.appendChild(div);
            console.log(`${success ? '‚úÖ' : '‚ùå'} ${message}`);
        }

        async function runTests() {
            // Test 1: Basic URL parameter reading
            addResult('Starting tests...', true);
            
            const urlParams = new URLSearchParams(window.location.search);
            const paperId = urlParams.get('paperId');
            
            if (paperId) {
                addResult(`URL parameter found: paperId=${paperId}`, true);
            } else {
                addResult('No paperId in URL', false);
                return;
            }
            
            // Test 2: Check localStorage for papers
            const localPapers = localStorage.getItem('questionPapers');
            if (localPapers) {
                try {
                    const papers = JSON.parse(localPapers);
                    addResult(`LocalStorage has ${papers.length} papers`, true);
                    
                    // Test 3: Try to find the paper in localStorage
                    const numericPaperId = Number(paperId);
                    const paper = papers.find(p => Number(p.id) === numericPaperId);
                    
                    if (paper) {
                        addResult(`Paper found in localStorage: ${paper.subject}`, true);
                        
                        // Test 4: Try to show paper content
                        if (paper.pages && paper.pages.length > 0) {
                            addResult(`Paper has ${paper.pages.length} pages`, true);
                            
                            // Create a simple viewer
                            const viewer = document.createElement('div');
                            viewer.style.marginTop = '20px';
                            viewer.style.padding = '20px';
                            viewer.style.background = '#444';
                            viewer.style.borderRadius = '10px';
                            
                            viewer.innerHTML = `
                                <h2>üìÑ ${paper.subject}</h2>
                                <p><strong>Paper ID:</strong> ${paper.id}</p>
                                <p><strong>Pages:</strong> ${paper.pages.length}</p>
                                <img src="${paper.pages[0]}" 
                                     style="max-width: 100%; height: auto; border-radius: 5px;"
                                     alt="Paper page 1" />
                            `;
                            
                            results.appendChild(viewer);
                            addResult('Paper displayed successfully!', true);
                            
                        } else {
                            addResult('Paper has no pages', false);
                        }
                    } else {
                        addResult(`Paper ID ${paperId} not found in localStorage`, false);
                        addResult('Available IDs: ' + papers.map(p => p.id).join(', '), false);
                    }
                    
                } catch (error) {
                    addResult(`Error parsing localStorage: ${error.message}`, false);
                }
            } else {
                addResult('No papers in localStorage', false);
            }
        }

        // Run tests when page loads
        runTests();
    </script>
</body>
</html>